<!DOCTYPE html>
<html>
<head>
    <title>OpenType.js</title>
    <meta charset="utf-8">
    <script type="text/javascript" src="opentype.js"></script>
    <style type="text/css">
        body {
            font: 10px arial, sans-serif;
        }

        .wrapper {
            border: 1px solid #ccc;
            margin: 4px;
            float: left;
        }

        .wrapper canvas {
            display: inline-block;
        }

        .wrapper span {
            text-align: center;
            background: lightgray;
            display: block;
        }
    </style>


</head>
<body>


<input type="text" style="font-size: 24px; padding: 5px 10px" onkeyup="renderText()" value="Hello, World!"
       autofocus id="textField">
<input type="checkbox" onmouseup="kerningChanged(this)" checked="checked"/>Kerning
<br>

<canvas id="preview" width="800" height="200" style="border: 1px solid #ccc"></canvas>
<br>
<span id="message"></span>

<script type="text/javascript">
    var fontReady = false;
    var textToRender = "Hello, World!";
    var kerning = true;

    function kerningChanged(e) {
        kerning = !kerning;
        renderText();
    }

    function renderText() {
        textToRender = document.getElementById('textField').value;
        if (!fontReady) return;
        var path = font.getPath(textToRender, {kerning: kerning});
        var ctx = document.getElementById("preview").getContext("2d");
        var size = 200;
        ctx.clearRect(0, 0, 800, 200);
        ctx.save();
        ctx.translate(10, size / 2);
        ctx.beginPath();
        ctx.moveTo(-10000, 0);
        ctx.lineTo(10000, 0);
        ctx.stroke();
        ctx.scale(size / 6144, size / 6144);
        path.draw(ctx);
        path.drawPoints(ctx);
        ctx.restore();
    }

    var req = new XMLHttpRequest();
    req.open('get', 'Roboto-Black.ttf', true);
    req.responseType = 'arraybuffer';
    req.onload = function (e) {
        var arrayBuffer = req.response;
        var font = openType.parseFont(arrayBuffer);
        window.font = font;
        if (!font.supported) {
            document.getElementById('message').innerHTML = '<strong>This font is not supported.</strong>';
        }
        fontReady = true;
        // Show only the first 100 glyphs.
        var amount = Math.min(100, font.glyphs.length);
        for (var i = 0; i < amount; i++) {
            var glyph = font.glyphs[i];
            var size = 200;
            var ctx = openType.createCanvas(size, i);
            var path = openType.glyphToPath(glyph);
            path.draw(ctx);
            openType.drawGlyphPoints(ctx, glyph);
            openType.drawMetrics(ctx, glyph);
        }
        renderText();

    };
    req.send(null);

</script>
</body>
</html>